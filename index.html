<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BlattaLab｜蜚蠊介紹與販售</title>
  <meta name="description" content="BlattaLab 專注於蜚蠊（Blattodea）的研究、繁育與教育推廣。提供科學化的物種資訊與飼養建議，並提供購買服務。" />
  <meta name="color-scheme" content="light dark" />
  <style>
    
  </style>
</head>
<body>

  <template id="card-tpl">
    <article class="card" data-genus="" data-tags="">
      <div class="thumb" aria-hidden="true"><div class="ph">待補圖片</div></div>
      <div class="card-body">
        <div class="latin"></div>
        <div class="cn"></div>
        <div class="meta"></div>
        <div class="row temp"></div>
        <div class="row diet"></div>
        <div class="row diff"></div>
        <div class="buy">
          <a class="btn" target="_blank" rel="noopener">物種介紹</a>
          <a class="btn primary" target="_blank" rel="noopener">購買連結</a>
        </div>
      </div>
    </article>
  </template>

  <script>
    const STORE_URL = "https://myship.7-11.com.tw/general/detail/GM2508133179359";

    const DATA = [
      {genus:"Gyna", species:"centurio_m", latin:"Gyna centurio", cn:"百夫長瓷蠊（雄）", features:"雌雄二型明顯，雄米白、雌深褐斑為主", origin:"非洲中部", habit:"樹棲與地表混合活動，夜行", diet:"蔬果、寵物糧", temp:"24–28°C；60–70%", diff:1, tags:["樹棲","新手友善"], info:"繁殖容易，環境要求低", img:"images/IMG_7930.jpg"},
      {genus:"Gyna", species:"centurio_f", latin:"Gyna centurio", cn:"百夫長瓷蠊（雌）", features:"雌雄二型明顯，雄米白、雌深褐斑為主", origin:"非洲中部", habit:"樹棲與地表混合活動，夜行", diet:"蔬果、寵物糧", temp:"24–28°C；60–70%", diff:1, tags:["樹棲","新手友善"], info:"繁殖容易，環境要求低", img:"images/IMG_7931.JPG"},
      {genus:"Pseudoglomeris", species:"magnifica_m", latin:"Pseudoglomeris magnifica", cn:"越南金屬蜚蠊（雄）", features:"金綠金屬光澤，極為華麗", origin:"越南 Cuc Phuong", habit:"樹棲，日隱樹皮縫，夜間活動", diet:"水果、花粉、寵物乾糧", temp:"24–27°C；70–80%", diff:4, tags:["樹棲"], info:"需花粉與新鮮蔬果補充", img:"images/IMG_7950.JPG"},
      {genus:"Pseudoglomeris", species:"magnifica_f", latin:"Pseudoglomeris magnifica", cn:"越南金屬蜚蠊（雌）", features:"金綠金屬光澤，極為華麗", origin:"越南 Cuc Phuong", habit:"樹棲，日隱樹皮縫，夜間活動", diet:"水果、花粉、寵物乾糧", temp:"24–27°C；70–80%", diff:4, tags:["樹棲"], info:"需花粉與新鮮蔬果補充", img:"images/IMG_7951.JPG"},
      {genus:"Eucorydia", species:"dasytoides", latin:"Eucorydia dasytoides", cn:"帶紋绀蠊", features:"亮藍金屬色翼帶黃條", origin:"東南亞", habit:"樹棲，飛行力佳", diet:"花粉、蜂蜜水、蔬果、寵物乾糧", temp:"24–27°C；70–80%", diff:3, tags:["樹棲"], info:"雄蟲需供應花粉", img:"images/IMG_7960.JPG"},
      {genus:"Macropanesthia", species:"rhinoceros", latin:"Macropanesthia rhinoceros", cn:"犀牛蜚蠊", features:"世界最重大型蜚蠊", origin:"澳洲昆士蘭", habit:"土棲，挖掘地洞久居", diet:"尤加利落葉、胡桃葉", temp:"24–28°C；60–75%", diff:5, tags:["土棲","進階"], info:"生長周期極長", img:"images/IMG_8750.JPG"},
      {genus:"Therea", species:"regularis", latin:"Therea regularis", cn:"多米諾橘骨牌蜚蠊", features:"黑底搭配橘白斑", origin:"印度", habit:"地棲", diet:"蔬果、寵物糧", temp:"24–28°C；60–70%", diff:1, tags:["地棲","新手友善"], info:"容錯率高", img:"images/IMG_9157.JPG"},
      {genus:"Therea", species:"bernhardti", latin:"Therea bernhardti", cn:"多米諾骨牌蜚蠊", features:"黑底白圓斑", origin:"印度", habit:"地棲", diet:"蔬果、寵物糧", temp:"24–28°C；60–70%", diff:1, tags:["地棲","新手友善"], info:"適應性強", img:"images/IMG_9342.JPG"},
      {genus:"Therea", species:"olegrandjeani", latin:"Therea olegrandjeani", cn:"問號蜚蠊", features:"黑底白色問號狀斑紋", origin:"印度", habit:"地棲", diet:"蔬果、寵物糧", temp:"24–28°C；60–80%", diff:2, tags:["地棲","新手+"], info:"需乾濕梯度", img:"images/IMG20181211214008.JPG"},
      {genus:"Gyna", species:"caffrorum", latin:"Gyna caffrorum", cn:"卡佛爾瓷蠊", features:"淡米至淺棕翅", origin:"南非", habit:"樹棲", diet:"蔬果、寵物糧", temp:"24–28°C；60–70%", diff:1, tags:["樹棲","新手友善"], info:"適應力佳", img:"images/Snapseed.jpg"}
    ];

    const genusOrder = [
      "Therea","Gyna","Pseudoglomeris","Eucorydia","Macropanesthia"
    ];

    const $grid = document.getElementById('grid');
    const $count = document.getElementById('count');
    const $tabs = document.querySelector('.genus-tabs');
    const $q = document.getElementById('q');
    const $difficulty = document.getElementById('difficulty');
    const $chips = Array.from(document.querySelectorAll('.chip'));

    function starSVG(fill){
      return `<svg viewBox="0 0 24 24" aria-hidden="true"><path fill="${fill? '#f3c96a':'#3a4653'}" d="M12 17.3l-6.1 3.6 1.6-6.9L2 8.9l7-.6L12 1.9l3 6.4 7 .6-5.5 5.1 1.6 6.9z"/></svg>`
    }

    function makeCard(item){
      const tpl = document.getElementById('card-tpl');
      const node = tpl.content.firstElementChild.cloneNode(true);
      node.dataset.genus = item.genus;
      node.dataset.tags = item.tags.join(',');

      const thumb = node.querySelector('.thumb');
      if(item.img){
        thumb.innerHTML = `<img src="${item.img}" alt="${item.cn}" style="width:100%;height:100%;object-fit:cover">`;
      }

      node.querySelector('.latin').textContent = `${item.latin}`;
      node.querySelector('.cn').textContent = item.cn;
      const meta = node.querySelector('.meta');
      meta.innerHTML = `
        <span class="tag">產地：${item.origin}</span>
        <span class="tag">習性：${item.habit}</span>
        <span class="tag">特徵：${item.features}</span>
      `;
      node.querySelector('.temp').textContent = `溫濕度：${item.temp}`;
      node.querySelector('.diet').textContent = `食性：${item.diet}`;

      const diffRow = node.querySelector('.diff');
      diffRow.innerHTML = `難度：<span class="stars">${Array.from({length:5},(_,i)=>starSVG(i<item.diff)).join('')}</span>`;

      const [btnInfo, btnBuy] = node.querySelectorAll('.buy .btn');
      btnInfo.href = `#${item.genus}-${item.species}`;
      btnInfo.addEventListener('click', e=>{
        e.preventDefault();
        alert(`${item.latin}（${item.cn}）\n\n重點：${item.info}`);
      });
      btnBuy.href = STORE_URL;
      return node;
    }

    function render(genusFilter, query, diffFilter, tagSet){
      $grid.innerHTML = '';
      let list = [...DATA];
      if(genusFilter && genusFilter!=="ALL") list = list.filter(x=>x.genus===genusFilter);
      if(query){
        const q = query.trim().toLowerCase();
        list = list.filter(x => `${x.latin} ${x.cn} ${x.features} ${x.habit} ${x.origin}`.toLowerCase().includes(q));
      }
      if(diffFilter){
        list = list.filter(x=> x.diff === Number(diffFilter));
      }
      if(tagSet.size){
        list = list.filter(x=> x.tags.some(t=> tagSet.has(t)));
      }
      list.forEach(item=> $grid.appendChild(makeCard(item)));
      $count.textContent = `${list.length} 筆`;
    }

    function buildTabs(){
      const uniq = Array.from(new Set(DATA.map(x=>x.genus)));
      const ordered = genusOrder.filter(g=>uniq.includes(g)).concat(uniq.filter(g=>!genusOrder.includes(g)));
      const all = document.createElement('button'); all.className='tab active'; all.dataset.genus='ALL'; all.textContent='全部';
      $tabs.appendChild(all);
      ordered.forEach(g=>{
        const b = document.createElement('button');
        b.className='tab'; b.dataset.genus=g; b.textContent=g;
        $tabs.appendChild(b);
      });
    }

    function initFilters(){
      const activeTags = new Set();
      let activeGenus = 'ALL';
      function sync(){
        render(activeGenus, $q.value, $difficulty.value, activeTags);
      }
      $tabs.addEventListener('click', e=>{
        const btn = e.target.closest('.tab'); if(!btn) return; activeGenus = btn.dataset.genus; sync();
      });
      $q.addEventListener('input', sync);
      $difficulty.addEventListener('change', sync);
      $chips.forEach(c=>{
        c.addEventListener('click', ()=>{ const k=c.dataset.tag; activeTags.has(k)?activeTags.delete(k):activeTags.add(k); sync(); });
      });
      sync();
    }

    function init(){
      buildTabs();
      initFilters();
    }
    init();
  </script>
</body>
</html>
